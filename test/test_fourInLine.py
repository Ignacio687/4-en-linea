import unittest
from main.fourInLine import *
from parameterized import parameterized

class FourInRowTestCase(unittest.TestCase):

    def setUp(self):
        self.fourInRow = FourInLine()

    def test_returnBoardAndBoardGeneration(self):
        self.assertEqual(self.fourInRow.returnBoard(), [
        ['', '', '', '', '', '', '', ''], 
        ['', '', '', '', '', '', '', ''], 
        ['', '', '', '', '', '', '', ''], 
        ['', '', '', '', '', '', '', ''], 
        ['', '', '', '', '', '', '', ''], 
        ['', '', '', '', '', '', '', ''], 
        ['', '', '', '', '', '', '', ''], 
        ['', '', '', '', '', '', '', '']])

    def test_setBoard(self):
        self.fourInRow.setBoard([
            [1, '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', 0, ''], 
            ['', '', 1, '', '', 0, '', ''], 
            ['', '', '', '', 0, '', '', ''], 
            ['', '', '', 0, '', '', '', ''], 
            ['', '', 0, '', '', '', '', 1], 
            [0, '', '', '', '', '', '', ''], 
            ['', '', '', 1, '', '', '', '']])
        self.assertEqual(self.fourInRow.returnBoard(), [
            [1, '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', 0, ''], 
            ['', '', 1, '', '', 0, '', ''], 
            ['', '', '', '', 0, '', '', ''], 
            ['', '', '', 0, '', '', '', ''], 
            ['', '', 0, '', '', '', '', 1], 
            [0, '', '', '', '', '', '', ''], 
            ['', '', '', 1, '', '', '', '']])

    def test_resetfourInRow(self):
        self.fourInRow.setBoard([
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', 0, ''], 
            ['', '', '', '', '', 0, '', ''], 
            ['', '', '', '', 0, '', '', ''], 
            ['', '', '', 0, '', '', '', ''], 
            ['', '', 0, '', '', '', '', ''], 
            [0, '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', 0]]) 
        self.fourInRow.resetBoard()
        self.assertEqual(self.fourInRow.returnBoard(), [
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', '']])
    
    @parameterized.expand([(0, 5), (1, 7),(2, 4), (3, 3), (4, 2), (5, 1), (6, 0), (7, 6)])
    def test_NextcolumnPositionSelector(self, column, row):
        self.fourInRow.setBoard([
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', 0, ''], 
            ['', '', '', '', '', 0, '', ''], 
            ['', '', '', '', 0, '', '', ''], 
            ['', '', '', 0, '', '', '', ''], 
            ['', '', 0, '', '', '', '', ''], 
            [0, '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', 0]])
        self.assertEqual(self.fourInRow.NAPICS(column), row)

    @parameterized.expand([(0,),(3,),(7,)])
    def test_NextcolumnPositionSelect_Exception(self, column):
        self.fourInRow.setBoard([
            [0, '', '', 0, '', '', '', 0], 
            ['', '', '', '', '', '', 0, ''], 
            ['', '', '', '', '', 0, '', ''], 
            ['', '', '', '', 0, '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', 0, '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', '']])
        with self.assertRaises(NoAvailablePositionException):
            self.fourInRow.NAPICS(column)

    def test_InsertToken(self):
        self.fourInRow.insertToken(3)
        self.assertEqual(self.fourInRow.returnBoard(), [
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', 0, '', '', '', '']])
    
    def test_turnChange(self):
        self.fourInRow.insertToken(4)
        self.assertEqual(self.fourInRow.returnTurn(), 1)
        self.fourInRow.insertToken(2)
        self.assertEqual(self.fourInRow.returnTurn(), 0)

    def test_InsertToken_Exception(self):
        self.fourInRow.setBoard([
            ['', '', '', '', '', '', 1, ''], 
            ['', '', '', '', '', '', 0, ''], 
            ['', '', '', '', '', '', 0, ''], 
            ['', '', '', '', '', '', 1, ''], 
            ['', '', '', '', '', '', 1, ''], 
            ['', '', '', '', '', '', 1, ''], 
            ['', '', '', '', '', '', 1, ''], 
            ['', '', '', '', '', '', 0, '']])
        with self.assertRaises(NoAvailablePositionException):
            self.fourInRow.insertToken(6)

    def test_InsertToken_OutOfRangeException(self):
        with self.assertRaises(OutOfRangeException):
            self.fourInRow.insertToken(11)

    def test_InsertToken_FormatException(self):
        with self.assertRaises(FormatException):
            self.fourInRow.insertToken('#')
        with self.assertRaises(FormatException):
            self.fourInRow.insertToken('a')


    @parameterized.expand([(
                            [['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', 0, 0, 0, '', ''], 
                             ['', '', '', '', '', 0, 1, ''], 
                             ['', '', '', '', '', 0, 1, '']], 6
                           ),
                           (
                             [['', '', '', '', '', '', '', ''], 
                              ['', '', '', '', '', '', '', ''], 
                              ['', '', '', '', '', '', '', ''], 
                              ['', '', '', '', '', '', '', ''], 
                              ['', '', '', '', '', '', '', ''], 
                              ['', '', '', '', '', '', '', ''], 
                              ['', '', '', '', '', '', '', ''], 
                              ['', '', '', '', '', 0, 0, 0]], 4
                           )
                          ])
    def test_VerifyLineWinnerCondition(self, board, column):
        self.fourInRow.setBoard(board)
        with self.assertRaises(WinnerException):
            self.fourInRow.insertToken(column)

    @parameterized.expand([(
                        [['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', 0, '', ''], 
                            ['', '', '', 0, 0, 0, 1, ''], 
                            ['', '', '', '', '', 0, '', ''], 
                            ['', '', '', '', '', 1, '', '']], 5 
                        ),
                        (
                            [['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', 0, ''], 
                            ['', '', '', '', '', '', 0, ''], 
                            ['', '', '', '', '', '', 0, ''], 
                            ['', '', '', '', '', '', 1, ''], 
                            ['', '', '', '', '', '', 0, ''], 
                            ['', '', '', '', '', '', 1, ''], 
                            ['', '', '', '', '', 1, 0, 1]], 6
                        )
                        ])
    def test_VerifyColumnWinnerCondition(self, board, column):
        self.fourInRow.setBoard(board)
        with self.assertRaises(WinnerException):
            self.fourInRow.insertToken(column) 

    @parameterized.expand([(
                            [[1, '', '', '', '', '', '', ''], 
                             ['', 0, '', '', '', '', '', ''], 
                             ['', '', 0, '', '', '', '', ''], 
                             ['', '', '', 0, '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', 1, 1, '', ''], 
                             ['', '', '', '', '', '', 0, ''], 
                             ['', '', '', '', '', '', '', 1]], 4 
                           ),
                           (
                            [['', '', '', '', 0, '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', 1, 0, ''], 
                             ['', '', '', '', '', '', '', 0], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', '']], 5
                           ),
                           (
                            [['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             [1, '', '', '', '', '', '', ''], 
                             ['', 0, '', '', '', '', '', ''], 
                             ['', '', 0, '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', 1, 0, '', '', '']], 3
                           )
                          ])
    def test_VerifyDiagonalToTheRigth_WinnerCondition(self, board, column):
        self.fourInRow.setBoard(board)
        with self.assertRaises(WinnerException):
            self.fourInRow.insertToken(column) 
    
    @parameterized.expand([(
                        [['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', 0, 1], 
                            ['', '', '', '', '', 0, '', ''], 
                            ['', '', '', '', 0, '', '', ''], 
                            ['', '', '', 1, '', '', '', ''], 
                            ['', '', 0, '', '', '', '', ''], 
                            ['', 0, '', '', '', '', '', ''], 
                            [1, '', '', '', '', '', '', '']], 7
                        ),
                        (
                        [['', '', '', 0, '', '', '', ''], 
                            ['', '', 0, '', '', '', '', ''], 
                            ['', 0, '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            [1, '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', '']], 0
                        ),
                        (
                        [['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', 0, ''], 
                            ['', '', '', '', '', 0, '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', 0, 1, '', '', '']], 4
                        )
                        ])
    def test_VerifyDiagonalToTheLeft_WinnerCondition(self, board, column):
        self.fourInRow.setBoard(board)
        with self.assertRaises(WinnerException):
            self.fourInRow.insertToken(column) 
#here
    @parameterized.expand([(
                            [['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', 0, 0, '', ''], 
                             ['', '', '', '', '', 0, 1, ''], 
                             ['', '', '', '', '', 0, 1, '']], 6
                           ),
                           (
                             [['', '', '', '', '', '', '', ''], 
                              ['', '', '', '', '', '', '', ''], 
                              ['', '', '', '', '', '', '', ''], 
                              ['', '', '', '', '', '', '', ''], 
                              ['', '', '', '', '', '', '', ''], 
                              ['', '', '', '', '', '', '', ''], 
                              ['', '', '', '', '', '', '', ''], 
                              ['', '', '', '', '', 0, 0, '']], 4
                           )
                          ])
    def test_VerifyLineWinnerCondition_NotRaise(self, board, column):
        self.fourInRow.setBoard(board)
        self.fourInRow.insertToken(column)

    @parameterized.expand([(
                        [['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', 0, '', ''], 
                            ['', '', '', 0, 0, 1, 1, ''], 
                            ['', '', '', '', '', 0, '', ''], 
                            ['', '', '', '', '', 1, '', '']], 5 
                        ),
                        (
                            [['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', 0, ''], 
                            ['', '', '', '', '', '', 0, ''], 
                            ['', '', '', '', '', '', 1, ''], 
                            ['', '', '', '', '', '', 1, ''], 
                            ['', '', '', '', '', '', 0, ''], 
                            ['', '', '', '', '', '', 1, ''], 
                            ['', '', '', '', '', 1, 0, 1]], 6
                        )
                        ])
    def test_VerifyColumnWinnerCondition_NotRaise(self, board, column):
        self.fourInRow.setBoard(board)
        self.fourInRow.insertToken(column) 

    @parameterized.expand([(
                            [[1, '', '', '', '', '', '', ''], 
                             ['', 1, '', '', '', '', '', ''], 
                             ['', '', 0, '', '', '', '', ''], 
                             ['', '', '', 0, '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', 1, 1, '', ''], 
                             ['', '', '', '', '', '', 0, ''], 
                             ['', '', '', '', '', '', '', 1]], 4 
                           ),
                           (
                            [['', '', '', '', 0, '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', 1, 0, ''], 
                             ['', '', '', '', '', '', '', 1], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', '']], 5
                           ),
                           (
                            [['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             [1, '', '', '', '', '', '', ''], 
                             ['', 0, '', '', '', '', '', ''], 
                             ['', '', 0, '', '', '', '', ''], 
                             ['', '', '', '', '', '', '', ''], 
                             ['', '', '', 1, 1, '', '', '']], 3
                           )
                          ])
    def test_VerifyDiagonalToTheRigth_WinnerCondition_NotRaise(self, board, column):
        self.fourInRow.setBoard(board)
        self.fourInRow.insertToken(column) 
    
    @parameterized.expand([(
                        [['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', 0, 1], 
                            ['', '', '', '', '', 0, '', ''], 
                            ['', '', '', '', 1, '', '', ''], 
                            ['', '', '', 1, '', '', '', ''], 
                            ['', '', 0, '', '', '', '', ''], 
                            ['', 0, '', '', '', '', '', ''], 
                            [1, '', '', '', '', '', '', '']], 7
                        ),
                        (
                        [['', '', '', 1, '', '', '', ''], 
                            ['', '', 0, '', '', '', '', ''], 
                            ['', 0, '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            [1, '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', '']], 0
                        ),
                        (
                        [['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', '', '', '', 1, ''], 
                            ['', '', '', '', '', 0, '', ''], 
                            ['', '', '', '', '', '', '', ''], 
                            ['', '', '', 0, 1, '', '', '']], 4
                        )
                        ])
    def test_VerifyDiagonalToTheLeft_WinnerCondition_NotRaise(self, board, column):
        self.fourInRow.setBoard(board)
        self.fourInRow.insertToken(column) 

    def test_tie(self):
        self.fourInRow.setBoard([
            [0, 1, 0, '', 0, '', 1, 0], 
            ['', '', 1, 0, 0, 1, 0, ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', ''], 
            ['', '', '', '', '', '', '', '']])
        self.fourInRow.insertToken(3)
        with self.assertRaises(TieException):
            self.fourInRow.insertToken(5)